import{r as t,j as e,w as G,x as Q,E as le,h as U,y as D,B as N,z as ce,A as de,F as ue,G as A,H as me,J as pe,K as xe,N as he,b as W,c as Y,d as E,e as L,C as V,O as X,V as Z,W as ge,X as fe,f as k,k as ye,a as P,Y as be,Z as je,_ as ve,s as Ce,$ as Ne,a0 as we,a1 as Se,a2 as Te,a3 as z,a4 as Fe}from"./index-68JtM4Cd.js";import{N as Ie,F as Pe}from"./footer-Z09FTuhT.js";import{A as K}from"./AnimatedSection-BCVpFQZW.js";import{H as Oe}from"./HeroSection-BGxOdh-p.js";import{I as J}from"./InlineTextarea-BsAcal64.js";import"./proxy-CmXc19OU.js";function O({faq:a,onIncrementViews:c,onVoteHelpful:r,hasVoted:o=!1}){const[n,p]=t.useState(!1),m=()=>{!n&&c&&c(a.id),p(!n)},h=x=>{x.stopPropagation(),r&&r(a.id)};return e.jsxs("div",{className:"border border-gray-200 rounded-lg",children:[e.jsxs("button",{onClick:m,className:"w-full px-6 py-4 text-left flex items-center justify-between hover:bg-gray-50 transition-colors",children:[e.jsx("h3",{className:"font-medium text-gray-900 pr-4",children:a.question}),n?e.jsx(G,{className:"h-5 w-5 text-gray-500 flex-shrink-0"}):e.jsx(Q,{className:"h-5 w-5 text-gray-500 flex-shrink-0"})]}),n&&e.jsxs("div",{className:"px-6 pb-6",children:[e.jsx("div",{className:"prose prose-sm max-w-none text-gray-700 mb-4",children:a.answer.split(`
`).map((x,i)=>e.jsx("p",{className:"mb-2",children:x},i))}),e.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-gray-100",children:[e.jsxs("div",{className:"flex items-center space-x-4 text-sm text-gray-500",children:[a.views!==void 0&&e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(le,{className:"h-4 w-4"}),e.jsxs("span",{children:[a.views," visualizaciones"]})]}),a.helpfulVotes!==void 0&&a.helpfulVotes>0&&e.jsxs(U,{variant:"secondary",className:"text-xs",children:[e.jsx(D,{className:"h-3 w-3 mr-1"}),a.helpfulVotes," útil",a.helpfulVotes!==1?"es":""]})]}),e.jsxs(N,{variant:o?"default":"outline",size:"sm",onClick:h,disabled:o,className:"text-xs",children:[e.jsx(D,{className:"h-3 w-3 mr-1"}),o?"¡Votado!":"¿Te fue útil?"]})]})]})]})}var _="Collapsible",[Re,Je]=de(_),[Ee,q]=Re(_),ee=t.forwardRef((a,c)=>{const{__scopeCollapsible:r,open:o,defaultOpen:n,disabled:p,onOpenChange:m,...h}=a,[x=!1,i]=ce({prop:o,defaultProp:n,onChange:m});return e.jsx(Ee,{scope:r,disabled:p,contentId:ue(),open:x,onOpenToggle:t.useCallback(()=>i(b=>!b),[i]),children:e.jsx(A.div,{"data-state":M(x),"data-disabled":p?"":void 0,...h,ref:c})})});ee.displayName=_;var se="CollapsibleTrigger",ae=t.forwardRef((a,c)=>{const{__scopeCollapsible:r,...o}=a,n=q(se,r);return e.jsx(A.button,{type:"button","aria-controls":n.contentId,"aria-expanded":n.open||!1,"data-state":M(n.open),"data-disabled":n.disabled?"":void 0,disabled:n.disabled,...o,ref:c,onClick:me(a.onClick,n.onOpenToggle)})});ae.displayName=se;var H="CollapsibleContent",te=t.forwardRef((a,c)=>{const{forceMount:r,...o}=a,n=q(H,a.__scopeCollapsible);return e.jsx(pe,{present:r||n.open,children:({present:p})=>e.jsx(Le,{...o,ref:c,present:p})})});te.displayName=H;var Le=t.forwardRef((a,c)=>{const{__scopeCollapsible:r,present:o,children:n,...p}=a,m=q(H,r),[h,x]=t.useState(o),i=t.useRef(null),b=xe(c,i),w=t.useRef(0),f=w.current,S=t.useRef(0),j=S.current,v=m.open||h,d=t.useRef(v),y=t.useRef(void 0);return t.useEffect(()=>{const g=requestAnimationFrame(()=>d.current=!1);return()=>cancelAnimationFrame(g)},[]),he(()=>{const g=i.current;if(g){y.current=y.current||{transitionDuration:g.style.transitionDuration,animationName:g.style.animationName},g.style.transitionDuration="0s",g.style.animationName="none";const C=g.getBoundingClientRect();w.current=C.height,S.current=C.width,d.current||(g.style.transitionDuration=y.current.transitionDuration,g.style.animationName=y.current.animationName),x(o)}},[m.open,o]),e.jsx(A.div,{"data-state":M(m.open),"data-disabled":m.disabled?"":void 0,id:m.contentId,hidden:!v,...p,ref:b,style:{"--radix-collapsible-content-height":f?`${f}px`:void 0,"--radix-collapsible-content-width":j?`${j}px`:void 0,...a.style},children:v&&n})});function M(a){return a?"open":"closed"}var Ve=ee;const ke=Ve,Ae=ae,_e=te;function R({faq:a,onEdit:c,onDelete:r}){const[o,n]=t.useState(!1),{user:p}=W(),m=Y(),h=p?.role==="superuser",x=E({mutationFn:async i=>L(`/api/faqs/${a.id}`,{method:"PUT",body:JSON.stringify(i)}),onSuccess:()=>{m.invalidateQueries({queryKey:["/api/faqs"]})}});return e.jsx(V,{children:e.jsxs(ke,{open:o,onOpenChange:n,children:[e.jsx(X,{className:"pb-2",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx(Ae,{asChild:!0,children:e.jsxs("div",{className:"flex items-start gap-3 flex-1 cursor-pointer text-left",children:[h?e.jsx("div",{className:"flex-1",onClick:i=>i.stopPropagation(),children:e.jsx(J,{value:a.question||"",onSave:async i=>{await x.mutateAsync({question:i})},placeholder:"Pregunta frecuente...",className:"font-medium text-gray-900 leading-tight",rows:2,maxLength:200})}):e.jsx(Z,{className:"text-base font-medium text-gray-900 leading-tight flex-1",children:a.question}),e.jsx("div",{className:"flex-shrink-0 ml-2",children:o?e.jsx(G,{className:"h-5 w-5 text-gray-500"}):e.jsx(Q,{className:"h-5 w-5 text-gray-500"})})]})}),h&&e.jsxs("div",{className:"flex gap-1 ml-2",children:[e.jsx(N,{size:"sm",variant:"ghost",onClick:()=>c?.(a),children:e.jsx(ge,{className:"h-3 w-3"})}),e.jsx(N,{size:"sm",variant:"ghost",onClick:()=>r?.(a.id),children:e.jsx(fe,{className:"h-3 w-3"})})]})]})}),e.jsx(_e,{children:e.jsx(k,{className:"pt-2",children:h?e.jsx(J,{value:a.answer||"",onSave:async i=>{await x.mutateAsync({answer:i})},placeholder:"Respuesta a la pregunta...",className:"text-gray-600 leading-relaxed",rows:4}):e.jsx("p",{className:"text-gray-600 leading-relaxed whitespace-pre-wrap",children:a.answer})})})]})})}function qe(){const[a,c]=t.useState(""),[r,o]=t.useState("all"),[n,p]=t.useState(new Set),m=Y(),{toast:h}=ye(),{user:x}=W(),i=x?.role==="superuser";t.useEffect(()=>{const s=localStorage.getItem("faq-votes");if(s)try{const l=JSON.parse(s);t.startTransition(()=>{p(new Set(l))})}catch(l){console.error("Error loading saved votes:",l)}},[]);const{data:b,isLoading:w}=P({queryKey:["/api/faqs"],staleTime:300*1e3,refetchOnWindowFocus:!1,retry:1,suspense:!1}),{data:f,isLoading:S}=P({queryKey:["/api/faq-categories"],staleTime:600*1e3,refetchOnWindowFocus:!1,retry:1,suspense:!1}),{data:j,isLoading:v}=P({queryKey:["/api/config"],staleTime:600*1e3,refetchOnWindowFocus:!1,retry:1,suspense:!1}),{appearance:d}=t.useMemo(()=>({appearance:j?.config?.appearance||{}}),[j]),y=E({mutationFn:async s=>L(`/api/faqs/${s}/increment-views`,{method:"PUT",body:JSON.stringify({})}),onSuccess:()=>{t.startTransition(()=>{m.invalidateQueries({queryKey:["/api/faqs"]})})}}),g=E({mutationFn:async s=>{if(n.has(s))throw new Error("Ya has votado en esta pregunta frecuente.");return await L(`/api/faqs/${s}/vote-helpful`,{method:"PUT",body:JSON.stringify({})})},onSuccess:(s,l)=>{t.startTransition(()=>{const u=new Set(n);u.add(l),p(u),localStorage.setItem("faq-votes",JSON.stringify([...u])),m.invalidateQueries({queryKey:["/api/faqs"]})}),h({title:"¡Gracias por tu voto!",description:"Tu voto ha sido registrado correctamente."})},onError:s=>h({variant:"destructive",title:"Error al votar",description:s instanceof Error?s.message:"No se pudo registrar tu voto."})}),C=b?.filter(s=>s.isPublished)||[],T=C.filter(s=>{const l=s.question.toLowerCase().includes(a.toLowerCase())||s.answer.toLowerCase().includes(a.toLowerCase()),u=r==="all"||s.categoryId===r;return l&&u})||[],ne=f?.map(s=>({category:s,faqs:T.filter(l=>l.categoryId===s.id)})).filter(s=>s.faqs.length>0)||[],$=T.filter(s=>!s.categoryId),F=s=>{t.startTransition(()=>{y.mutate(s)})},I=s=>{t.startTransition(()=>{g.mutate(s)})},re=s=>{const l=s.target.value;t.startTransition(()=>{c(l)})},B=s=>{t.startTransition(()=>{o(s)})},oe=()=>{t.startTransition(()=>{c(""),o("all")})},ie=s=>{t.startTransition(()=>{o(s)})};return w||S||v?e.jsx(be,{}):e.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col",children:[e.jsx(Ie,{}),e.jsx(Oe,{title:"Preguntas Frecuentes",subtitle:"Encuentra respuestas a las dudas más comunes",appearance:d}),e.jsx(K,{children:e.jsxs("div",{className:"container mx-auto px-4 py-16 flex-1",children:[e.jsx(K,{delay:.2,children:e.jsxs(V,{className:"mb-10 shadow-lg border-0 rounded-2xl",children:[e.jsx(X,{children:e.jsxs(Z,{className:"flex items-center gap-2 text-blue-600",style:{color:d.primaryColor||"#000000"},children:[e.jsx(je,{className:"h-5 w-5"}),"Buscar y Filtrar"]})}),e.jsx(k,{children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(ve,{className:"absolute left-3 top-3 h-5 w-5 text-gray-400"}),e.jsx(Ce,{placeholder:"Buscar en las preguntas y respuestas...",value:a,onChange:re,className:"pl-10 border-blue-300 focus:border-blue-500 focus:ring focus:ring-blue-200 transition-all duration-300"})]}),e.jsx("div",{className:"sm:w-64",children:e.jsxs(Ne,{value:r,onValueChange:B,children:[e.jsx(we,{className:"border-blue-300 focus:border-blue-500 focus:ring focus:ring-blue-200 transition-all duration-300",children:e.jsx(Se,{placeholder:"Filtrar por categoría"})}),e.jsxs(Te,{children:[e.jsx(z,{value:"all",children:"Todas las categorías"}),f?.map(s=>e.jsx(z,{value:s.id,children:s.name},s.id))]})]})})]})})]})}),f&&f.length>0&&r==="all"&&e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-10",children:f.map(s=>{const l=C.filter(u=>u.categoryId===s.id).length;return e.jsxs("div",{className:"p-5 border rounded-2xl shadow hover:shadow-xl hover:bg-blue-50 cursor-pointer transition-all duration-300",onClick:()=>ie(s.id),children:[e.jsx("h3",{className:"font-bold text-lg text-gray-900 mb-1",children:s.name}),s.description&&e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:s.description}),e.jsxs(U,{variant:"outline",className:"text-blue-600 font-semibold",style:{color:d.primaryColor||"#000000",borderColor:d.primaryColor||"#000000"},children:[l," ",l===1?"pregunta":"preguntas"]})]},s.id)})}),e.jsxs("div",{className:"space-y-8",children:[r==="all"?e.jsxs(e.Fragment,{children:[ne.map(({category:s,faqs:l})=>e.jsxs("section",{children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-2xl font-semibold text-gray-900 mb-2",style:{color:d.headingColor||"#000000"},children:s.name}),s.description&&e.jsx("p",{className:"text-gray-600",children:s.description})]}),e.jsx("div",{className:"space-y-4",children:l.map(u=>i?e.jsx(R,{faq:u},u.id):e.jsx(O,{faq:u,onIncrementViews:()=>F(u.id),onVoteHelpful:()=>I(u.id),hasVoted:n.has(u.id),className:"rounded-xl shadow-sm hover:shadow-md transition-all duration-300 bg-white p-5"},u.id))})]},s.id)),$.length>0&&e.jsxs("section",{children:[e.jsx("div",{className:"mb-6",children:e.jsx("h2",{className:"text-2xl font-semibold text-gray-900 mb-2",style:{color:d.headingColor||"#000000"},children:"Preguntas Generales"})}),e.jsx("div",{className:"space-y-4",children:$.map(s=>i?e.jsx(R,{faq:s},s.id):e.jsx(O,{faq:s,onIncrementViews:()=>F(s.id),onVoteHelpful:()=>I(s.id),hasVoted:n.has(s.id),className:"rounded-xl shadow-sm hover:shadow-md transition-all duration-300 bg-white p-5"},s.id))})]})]}):e.jsxs("section",{children:[e.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-semibold text-gray-900 mb-2",style:{color:d.headingColor||"#000000"},children:f?.find(s=>s.id===r)?.name}),f?.find(s=>s.id===r)?.description&&e.jsx("p",{className:"text-gray-600",children:f.find(s=>s.id===r)?.description})]}),e.jsx(N,{variant:"outline",onClick:()=>B("all"),style:{borderColor:d.primaryColor||"#000000",color:d.primaryColor||"#000000"},children:"Ver Todas las Categorías"})]}),e.jsx("div",{className:"space-y-4",children:T.map(s=>i?e.jsx(R,{faq:s},s.id):e.jsx(O,{faq:s,onIncrementViews:()=>F(s.id),onVoteHelpful:()=>I(s.id),hasVoted:n.has(s.id),className:"rounded-xl shadow-sm hover:shadow-md transition-all duration-300 bg-white p-5"},s.id))})]}),T.length===0&&e.jsx(V,{className:"text-center py-20 bg-blue-50 rounded-xl shadow-lg",children:e.jsxs(k,{children:[e.jsx(Fe,{className:"h-20 w-20 mx-auto text-blue-400 mb-6 animate-pulse",color:d.iconColor||"#93c5fd"}),e.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-2",style:{color:d.headingColor||"#000000"},children:a||r!=="all"?"No se encontraron preguntas":"Aún no hay preguntas frecuentes"}),e.jsx("p",{className:"text-gray-600 mb-6",children:a||r!=="all"?"Intenta ajustar tus filtros de búsqueda":"Las preguntas frecuentes aparecerán aquí una vez que estén disponibles"}),(a||r!=="all")&&e.jsx(N,{onClick:oe,className:"bg-blue-600 text-white hover:bg-blue-700",style:{backgroundColor:d.primaryColor||"#000000"},children:"Limpiar Filtros"})]})})]})]})}),e.jsx(Pe,{})]})}function Ge(){return e.jsx(qe,{})}export{Ge as default};
