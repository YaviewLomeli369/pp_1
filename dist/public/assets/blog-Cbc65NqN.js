import{b as w,c as P,d as T,e as h,j as e,C as A,O as C,h as u,B as x,W as q,X as B,I as p,f as S,af as k,ag as E,L as g,E as j,a as f,V as L}from"./index-68JtM4Cd.js";import{N as y,F as N}from"./footer-Z09FTuhT.js";import{S as b}from"./seo-head-CvkVOmlP.js";import{I as D}from"./InlineTextarea-BsAcal64.js";import{A as v}from"./AnimatedSection-BCVpFQZW.js";import{H as F}from"./HeroSection-BGxOdh-p.js";import"./proxy-CmXc19OU.js";function I({post:s,onEdit:n,onDelete:m}){const{user:c}=w(),o=P(),l=c?.role==="superuser",i=T({mutationFn:async r=>h(`/api/blog/${s.id}`,{method:"PUT",body:JSON.stringify(r)}),onSuccess:()=>{o.invalidateQueries({queryKey:["/api/blog"]})}}),d=r=>new Date(r).toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric"}),a=r=>r?r.split(",").map(t=>t.trim()).filter(t=>t.length>0):[];return e.jsxs(A,{className:"h-full",children:[e.jsxs(C,{className:"pb-3",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(u,{variant:s.isPublished?"default":"secondary",children:s.isPublished?"Publicado":"Borrador"}),s.isFeatured&&e.jsx(u,{variant:"outline",children:"Destacado"})]}),l&&e.jsxs("div",{className:"flex gap-1",children:[e.jsx(x,{size:"sm",variant:"ghost",onClick:()=>n?.(s),children:e.jsx(q,{className:"h-3 w-3"})}),e.jsx(x,{size:"sm",variant:"ghost",onClick:()=>m?.(s.id),children:e.jsx(B,{className:"h-3 w-3"})})]})]}),l?e.jsx(p,{value:s.title,onSave:async r=>{await i.mutateAsync({title:r})},placeholder:"Título del artículo...",className:"text-xl font-bold text-gray-900 leading-tight",tag:"h3",maxLength:100}):e.jsx("h3",{className:"text-xl font-bold text-gray-900 leading-tight mb-2",children:s.title})]}),e.jsxs(S,{className:"pt-0",children:[e.jsx("div",{className:"mb-4",children:l?e.jsx(D,{value:s.excerpt||"",onSave:async r=>{await i.mutateAsync({excerpt:r})},placeholder:"Resumen del artículo...",className:"text-gray-600 leading-relaxed",rows:3,maxLength:300}):e.jsx("div",{className:"text-sm text-gray-600 mb-4 line-clamp-3",dangerouslySetInnerHTML:{__html:s.excerpt||s.content.substring(0,150).replace(/<[^>]*>/g,"")}})}),(s.tags||l)&&e.jsx("div",{className:"mb-4",children:l?e.jsx(p,{value:typeof s.tags=="string"?s.tags:Array.isArray(s.tags)?s.tags.join(", "):"",onSave:async r=>{await i.mutateAsync({tags:r})},placeholder:"Etiquetas separadas por comas...",className:"text-sm text-primary"}):e.jsx("div",{className:"flex flex-wrap gap-1",children:a(typeof s.tags=="string"?s.tags:Array.isArray(s.tags)?s.tags.join(", "):"").map((r,t)=>e.jsx("span",{className:"inline-block bg-primary/10 text-primary px-2 py-1 rounded-md text-xs",children:r},t))})}),e.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-500 mt-auto",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(k,{className:"h-3 w-3"}),e.jsx("span",{children:d(s.createdAt)})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(E,{className:"h-3 w-3"}),e.jsx("span",{children:s.authorName||"Admin"})]})]}),e.jsx(x,{size:"sm",variant:"outline",asChild:!0,children:e.jsx(x,{size:"sm",variant:"outline",asChild:!0,children:e.jsxs(g,{href:`/blog/${s.slug}`,children:[e.jsx(j,{className:"h-3 w-3 mr-1"}),"Ver"]})})})]})]})]})}function Q(){const{user:s}=w(),n=s?.role==="superuser",{data:m}=f({queryKey:["/api/config"],queryFn:()=>h("/api/config",{method:"GET"})}),{data:c,isLoading:o}=f({queryKey:["/api/blog"],queryFn:()=>h("/api/blog",{method:"GET"})}),i=m?.config?.appearance||{},d=n?c||[]:c?.filter(a=>a.isPublished)||[];return o?e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx(b,{title:"Blog"}),e.jsx(y,{}),e.jsx(v,{children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-primary border-t-transparent rounded-full mx-auto mb-4"}),e.jsx("p",{children:"Cargando artículos..."})]})})}),e.jsx(N,{})]}):e.jsxs("div",{className:"min-h-screen bg-background",style:{backgroundColor:i.backgroundColor||"inherit",color:i.textColor||"inherit",fontFamily:i.fontFamily||"inherit"},children:[e.jsx(b,{title:`Blog - ${i.brandName||"Sistema Modular"}`,description:"Artículos, noticias y actualizaciones"}),e.jsx(y,{}),e.jsx(F,{title:"Blog",subtitle:"Noticias, consejos y actualizaciones",appearance:i}),e.jsx(v,{delay:.2,children:e.jsx("section",{className:"py-16",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:d.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("h2",{className:"text-2xl font-semibold text-gray-900 mb-4",children:"No hay artículos disponibles"}),e.jsx("p",{className:"text-gray-600",children:"Pronto tendremos contenido interesante para compartir contigo."})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:d.map(a=>n?e.jsxs("div",{className:"relative",children:[e.jsx(I,{post:a}),e.jsxs(g,{href:`/blog/${a.slug}`,className:"absolute top-2 right-2 flex items-center gap-1 text-blue-600 hover:underline cursor-pointer",children:[e.jsx(j,{className:"w-4 h-4"}),e.jsx("span",{children:"Ver artículo"})]},a.id)]},a.id):e.jsx(g,{href:`/blog/${a.slug}`,className:"block",children:e.jsxs(A,{className:"hover:shadow-lg transition-shadow cursor-pointer",children:[a.featuredImage&&e.jsx("div",{className:"aspect-video w-full overflow-hidden rounded-t-lg",children:e.jsx("img",{src:a.featuredImage,alt:a.title,className:"w-full h-full object-cover"})}),e.jsxs(C,{children:[e.jsx("div",{className:"flex flex-wrap gap-2 mb-2",children:Array.isArray(a.tags)&&a.tags.map((r,t)=>e.jsx(u,{variant:"secondary",className:"text-xs",children:r},`${a.id}-${r}-${t}`))}),e.jsx(L,{className:"line-clamp-2 text-base sm:text-lg break-word",children:a.title})]}),e.jsxs(S,{children:[e.jsx("div",{className:"text-gray-600 text-sm mb-4 line-clamp-3",dangerouslySetInnerHTML:{__html:a.excerpt||a.content.substring(0,150).replace(/<[^>]*>/g,"")}}),e.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-500 flex-wrap gap-2",children:[e.jsxs("div",{className:"flex items-center space-x-2 sm:space-x-4 flex-wrap gap-2",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(E,{className:"w-4 h-4"}),e.jsx("span",{children:"Admin"})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(k,{className:"w-4 h-4"}),e.jsx("span",{children:new Date(a.publishedAt||a.createdAt).toLocaleDateString()})]})]}),a.views&&e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(j,{className:"w-4 h-4"}),e.jsx("span",{children:a.views})]})]})]})]})},a.id))})})})}),e.jsx(N,{})]})}export{Q as default};
