import{k,c as I,a as j,r as d,d as O,j as e,C as b,O as y,V as C,a8 as w,f as D,ao as M,ap as B,aq as V,q as n,U as K,s as h,a5 as $,a6 as Q,$ as F,a0 as T,a1 as q,a2 as A,a3 as g,ar as U,t as J,B as L,af as z,h as x}from"./index-68JtM4Cd.js";import{N as G,F as W}from"./footer-Z09FTuhT.js";import{S as X}from"./seo-head-CvkVOmlP.js";import{A as Y}from"./AnimatedSection-BCVpFQZW.js";import{H as Z}from"./HeroSection-BGxOdh-p.js";import"./proxy-CmXc19OU.js";function re(){const{toast:u}=k();I();const{data:f}=j({queryKey:["/api/config"]}),{appearance:l}=d.useMemo(()=>({appearance:f?.config?.appearance||{}}),[f]),[s,o]=d.useState({name:"",email:"",phone:"",service:"",date:"",timeSlot:"",notes:""}),[i,S]=d.useState(""),[c,N]=d.useState([]),{data:r}=j({queryKey:["/api/reservation-settings"]}),{data:p}=j({queryKey:["/api/reservations/available-slots",i],enabled:!!i,queryFn:async()=>i?(await fetch(`/api/reservations/available-slots/${i}`)).json():null});d.useEffect(()=>{p?.availableSlots&&N(p.availableSlots)},[p]);const v=O({mutationFn:async a=>{const t=await fetch("/api/reservations",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)});if(!t.ok)throw new Error("Failed to create reservation");return t.json()},onSuccess:()=>{u({title:"Reserva creada exitosamente",description:"Su reserva ha sido procesada correctamente"}),o({name:"",email:"",phone:"",service:"",date:"",timeSlot:"",notes:""}),S(""),N([])},onError:a=>{u({variant:"destructive",title:"Error al crear la reserva",description:a?.message||"No se pudo procesar su solicitud"})}}),R=a=>{if(a.preventDefault(),!s.name||!s.email||!s.date||!s.timeSlot){u({variant:"destructive",title:"Campos requeridos",description:"Por favor complete todos los campos obligatorios"});return}const t={name:s.name,email:s.email,phone:s.phone||null,service:s.service||null,timeSlot:s.timeSlot,notes:s.notes||null,date:s.date,status:"pending"};v.mutate(t)},E=a=>{S(a),o(t=>({...t,date:a,timeSlot:""}))},m=a=>{const{name:t,value:H}=a.target;o(P=>({...P,[t]:H}))};return e.jsxs("div",{className:"min-h-screen bg-background",style:{backgroundColor:l.backgroundColor||"inherit",color:l.textColor||"inherit",fontFamily:l.fontFamily||"inherit"},children:[e.jsx(X,{title:`Reservas - ${l.brandName||"Sistema Modular"}`,description:"Haga su reserva con nosotros de manera fácil y rápida"}),e.jsx(G,{}),e.jsx(Z,{title:"Reservas",subtitle:"Agenda tu cita de manera fácil y rápida",appearance:l}),e.jsx(Y,{delay:.2,children:e.jsx("section",{className:"py-16",children:e.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs(b,{children:[e.jsx(y,{children:e.jsxs(C,{className:"text-2xl text-center flex items-center justify-center gap-2",children:[e.jsx(w,{className:"w-6 h-6"}),"Nueva Reserva"]})}),e.jsx(D,{children:r?.isActive?e.jsxs("form",{onSubmit:R,className:"space-y-6",children:[e.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx(n,{htmlFor:"name",children:"Nombre completo *"}),e.jsxs("div",{className:"relative",children:[e.jsx(K,{className:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),e.jsx(h,{id:"name",name:"name",value:s.name,onChange:m,placeholder:"Su nombre completo",className:"pl-10",required:!0})]})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"email",children:"Correo electrónico *"}),e.jsxs("div",{className:"relative",children:[e.jsx($,{className:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),e.jsx(h,{id:"email",name:"email",type:"email",value:s.email,onChange:m,placeholder:"su@email.com",className:"pl-10",required:!0})]})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"phone",children:"Teléfono"}),e.jsxs("div",{className:"relative",children:[e.jsx(Q,{className:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),e.jsx(h,{id:"phone",name:"phone",type:"tel",value:s.phone,onChange:m,placeholder:"+1 234 567 8900",className:"pl-10"})]})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"service",children:"Tipo de servicio"}),e.jsxs(F,{value:s.service,onValueChange:a=>o(t=>({...t,service:a})),children:[e.jsx(T,{children:e.jsx(q,{placeholder:"Seleccione un servicio"})}),e.jsx(A,{children:(r?.allowedServices||[]).map(a=>e.jsx(g,{value:a,children:a},a))})]})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"date",children:"Fecha *"}),e.jsx(h,{id:"date",name:"date",type:"date",value:i,onChange:a=>E(a.target.value),min:new Date().toISOString().split("T")[0],max:(()=>{const a=r?.maxAdvanceDays||30,t=new Date;return t.setDate(t.getDate()+a),t.toISOString().split("T")[0]})(),required:!0})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"timeSlot",children:"Hora disponible *"}),e.jsxs(F,{value:s.timeSlot,onValueChange:a=>o(t=>({...t,timeSlot:a})),disabled:!i,children:[e.jsx(T,{children:e.jsx(q,{placeholder:i?"Seleccione una hora":"Primero seleccione una fecha"})}),e.jsx(A,{children:c.length>0?c.map(a=>e.jsx(g,{value:a,children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(w,{className:"w-4 h-4"}),a]})},a)):i?e.jsx(g,{value:"no-slots-available",disabled:!0,children:"No hay horarios disponibles"}):null})]}),i&&c.length===0&&e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"No hay horarios disponibles para esta fecha. Intente con otra fecha."}),i&&c.length>0&&e.jsxs("p",{className:"text-sm text-green-600 mt-1 flex items-center gap-1",children:[e.jsx(U,{className:"w-4 h-4"}),c.length," horarios disponibles"]})]})]}),e.jsxs("div",{children:[e.jsx(n,{htmlFor:"notes",children:"Notas adicionales"}),e.jsx(J,{id:"notes",name:"notes",value:s.notes,onChange:m,rows:4,placeholder:"Cualquier información adicional sobre su cita..."})]}),e.jsx(L,{type:"submit",className:"w-full",disabled:v.isPending||!s.timeSlot,children:v.isPending?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"animate-spin w-4 h-4 border-2 border-white border-t-transparent rounded-full"}),"Procesando..."]}):e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(z,{className:"w-4 h-4"}),"Solicitar Reserva"]})})]}):e.jsxs(M,{children:[e.jsx(B,{className:"h-4 w-4"}),e.jsx(V,{children:"El sistema de reservas no está disponible en este momento. Por favor, contacte directamente para solicitar una cita."})]})})]}),r?.isActive&&e.jsxs(b,{className:"mt-8",children:[e.jsx(y,{children:e.jsx(C,{className:"text-lg",children:"Información de Horarios"})}),e.jsx(D,{children:e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"Duración de citas:"}),e.jsxs(x,{variant:"secondary",children:[r.defaultDuration," minutos"]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"Tiempo de separación:"}),e.jsxs(x,{variant:"secondary",children:[r.bufferTime," minutos"]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"Reservas con anticipación:"}),e.jsxs(x,{variant:"secondary",children:["Hasta ",r.maxAdvanceDays," días"]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"Servicios disponibles:"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:(r.allowedServices||[]).map(a=>e.jsx(x,{variant:"outline",children:a},a))})]})]})})]})]})})}),e.jsx(W,{})]})}export{re as default};
