import{j as e,C as f,f as N,h as y,Q,S as q,b as A,c as k,d as E,e as P,i as C,I as w,r as g,k as $,a as T,l as K,M as L,B as j,P as B,D as H,m as J,n as R,o as _,p as z,q as x,s as S,t as G,v as U}from"./index-68JtM4Cd.js";import{N as V,F as W}from"./footer-Z09FTuhT.js";import{I as X}from"./InlineTextarea-BsAcal64.js";import{H as Y}from"./HeroSection-BGxOdh-p.js";import"./AnimatedSection-BCVpFQZW.js";import"./proxy-CmXc19OU.js";function F({testimonial:a,featured:t=!1}){const r=i=>Array.from({length:5},(o,l)=>e.jsx(q,{className:`h-4 w-4 ${l<i?"text-yellow-400 fill-current":"text-gray-300"}`},l));return e.jsx(f,{className:`h-full ${t?"ring-2 ring-primary shadow-lg":""}`,children:e.jsxs(N,{className:"p-6",children:[t&&e.jsx(y,{className:"mb-4",variant:"default",children:"Destacado"}),e.jsxs("div",{className:"flex items-start mb-4",children:[e.jsx(Q,{className:"h-6 w-6 text-primary flex-shrink-0 mr-3 mt-1"}),e.jsx("p",{className:"text-gray-700 italic leading-relaxed",children:a.content})]}),e.jsxs("div",{className:"flex items-center justify-between mt-4 pt-4 border-t",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900",children:a.name}),e.jsxs("div",{className:"flex items-center mt-1",children:[r(a.rating),e.jsxs("span",{className:"ml-2 text-sm text-gray-600",children:[a.rating,"/5"]})]})]}),a.position&&e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm text-gray-600",children:a.position}),a.company&&e.jsx("p",{className:"text-xs text-gray-500",children:a.company})]})]})]})})}function D({testimonial:a,featured:t=!1}){const{user:r}=A(),i=k(),o=r?.role==="superuser",l=E({mutationFn:async n=>P(`/api/testimonials/${a.id}`,{method:"PUT",body:JSON.stringify(n)}),onSuccess:()=>{i.invalidateQueries({queryKey:["/api/testimonials"]})}});return e.jsxs(f,{className:`h-full relative ${t?"ring-2 ring-primary/20 shadow-lg":""}`,children:[t&&e.jsx("div",{className:"absolute -top-2 -right-2 bg-primary text-primary-foreground rounded-full p-1",children:e.jsx(C,{className:"w-4 h-4"})}),e.jsxs(N,{className:"p-6 flex flex-col h-full",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(y,{variant:a.isApproved?"default":"secondary",children:a.isApproved?"Aprobado":"Pendiente"}),a.isFeatured&&e.jsxs(y,{variant:"outline",children:[e.jsx(C,{className:"w-3 h-3 mr-1"}),"Destacado"]})]}),e.jsx("div",{className:"flex items-center",children:[...Array(5)].map((n,d)=>e.jsx(q,{className:`w-4 h-4 ${d<(a.rating||0)?"text-yellow-400 fill-yellow-400":"text-gray-300"}`},d))})]}),e.jsx("div",{className:"flex-grow",children:o?e.jsx(X,{value:a.content||"",onSave:async n=>{await l.mutateAsync({content:n})},placeholder:"Contenido del testimonial...",className:"text-gray-700 mb-4",rows:4,maxLength:500}):e.jsxs("blockquote",{className:"text-gray-700 mb-4",children:['"',a.content,'"']})}),e.jsx("div",{className:"mt-auto",children:e.jsx("div",{className:"border-t pt-4",children:o?e.jsxs(e.Fragment,{children:[e.jsx(w,{value:a.name||"",onSave:async n=>{await l.mutateAsync({name:n})},placeholder:"Nombre del cliente...",className:"font-semibold text-gray-900 block mb-1"}),e.jsx(w,{value:a.email||"",onSave:async n=>{await l.mutateAsync({email:n})},placeholder:"Email (opcional)...",className:"text-gray-600 text-sm"})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"font-semibold text-gray-900",children:a.name}),a.email&&e.jsx("div",{className:"text-gray-600 text-sm",children:a.email})]})})})]})]})}function ne(){const[a,t]=g.useState(!1),[r,i]=g.useState({name:"",email:"",content:"",rating:5}),o=k(),{toast:l}=$(),{user:n}=A(),d=n?.role==="superuser",{data:M,isLoading:I}=T({queryKey:["/api/testimonials"]}),u=E({mutationFn:async s=>await P("/api/testimonials",{method:"POST",body:JSON.stringify(s)}),onSuccess:()=>{o.invalidateQueries({queryKey:["/api/testimonials"]}),t(!1),i({name:"",email:"",content:"",rating:5}),l({title:"¡Gracias por tu testimonial!",description:"Tu testimonial ha sido enviado y está pendiente de aprobación."})}}),{data:v}=T({queryKey:["/api/config"]}),{appearance:m}=g.useMemo(()=>({appearance:v?.config?.appearance||{}}),[v]),O=s=>{s.preventDefault(),u.mutate(r)},h=M?.filter(s=>s.isApproved)||[],p=h.filter(s=>s.isFeatured),b=h.filter(s=>!s.isFeatured);return e.jsxs("div",{className:"min-h-screen bg-background",style:{backgroundColor:m.backgroundColor||"inherit",color:m.textColor||"inherit",fontFamily:m.fontFamily||"inherit"},children:[e.jsx(V,{}),e.jsx(Y,{title:"Testimonios",subtitle:"Lo que dicen nuestros clientes",appearance:m}),I?e.jsxs("div",{className:"flex flex-col items-center space-y-4 py-16",children:[e.jsx(K,{size:"lg",className:"text-primary"}),e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-lg font-semibold text-foreground",children:"Cargando testimonios..."}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Por favor espere mientras cargamos las experiencias de nuestros clientes."})]})]}):e.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-16 space-y-16",children:[" ",p.length>0&&e.jsxs("section",{className:"space-y-8",children:[e.jsx("h2",{className:"text-2xl font-semibold text-gray-900 text-center",children:"Testimonios Destacados"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:p.map(s=>d?e.jsx(D,{testimonial:s,featured:!0},s.id):e.jsx(F,{testimonial:s,featured:!0},s.id))})]}),e.jsxs("section",{className:"space-y-8",children:[b.length>0&&e.jsxs(e.Fragment,{children:[p.length>0&&e.jsx("h2",{className:"text-2xl font-semibold text-gray-900 text-center",children:"Más Testimonios"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:b.map(s=>d?e.jsx(D,{testimonial:s},s.id):e.jsx(F,{testimonial:s},s.id))})]}),h.length===0&&e.jsx(f,{className:"text-center py-16",children:e.jsxs(N,{children:[e.jsx(L,{className:"h-16 w-16 mx-auto text-gray-300 mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Aún no hay testimonios"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"¡Sé el primero en compartir tu experiencia!"}),e.jsxs(j,{onClick:()=>t(!0),children:[e.jsx(B,{className:"mr-2 h-4 w-4"}),"Escribir Testimonial"]})]})})]})]}),e.jsx(H,{open:a,onOpenChange:t,children:e.jsx(J,{className:"max-w-2xl",children:e.jsxs("form",{onSubmit:O,children:[e.jsxs(R,{children:[e.jsx(_,{children:"Compartir tu Experiencia"}),e.jsx(z,{children:"Cuéntanos sobre tu experiencia con nosotros. Tu testimonial ayudará a otros clientes."})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(x,{htmlFor:"name",children:"Nombre *"}),e.jsx(S,{id:"name",value:r.name,onChange:s=>i(c=>({...c,name:s.target.value})),required:!0,placeholder:"Tu nombre completo"})]}),e.jsxs("div",{children:[e.jsx(x,{htmlFor:"email",children:"Email"}),e.jsx(S,{id:"email",type:"email",value:r.email,onChange:s=>i(c=>({...c,email:s.target.value})),placeholder:"tu@email.com (opcional)"})]})]}),e.jsxs("div",{children:[e.jsx(x,{htmlFor:"rating",children:"Calificación"}),e.jsxs("div",{className:"flex items-center space-x-2 mt-2",children:[[1,2,3,4,5].map(s=>e.jsx("button",{type:"button",onClick:()=>i(c=>({...c,rating:s})),className:`text-2xl ${s<=r.rating?"text-yellow-400":"text-gray-300"} hover:text-yellow-400 transition-colors`,children:"★"},s)),e.jsxs("span",{className:"ml-2 text-sm text-gray-600",children:["(",r.rating," de 5 estrellas)"]})]})]}),e.jsxs("div",{children:[e.jsx(x,{htmlFor:"content",children:"Tu Testimonial *"}),e.jsx(G,{id:"content",value:r.content,onChange:s=>i(c=>({...c,content:s.target.value})),required:!0,rows:4,placeholder:"Comparte tu experiencia con nosotros..."})]})]}),e.jsxs(U,{children:[e.jsx(j,{type:"button",variant:"outline",onClick:()=>t(!1),children:"Cancelar"}),e.jsx(j,{type:"submit",disabled:u.isPending,children:u.isPending?"Enviando...":"Enviar Testimonial"})]})]})})}),e.jsx(W,{})]})}export{ne as default};
