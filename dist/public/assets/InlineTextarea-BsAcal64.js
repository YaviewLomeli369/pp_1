import{r as l,k as S,d as T,j as e,aT as $,t as b,B as v,aP as D,g as I,ac as K}from"./index-68JtM4Cd.js";function V({value:s,onSave:y,placeholder:d="Click to edit...",className:u="hidden",disabled:n=!1,maxLength:i,rows:E=3}){const[C,o]=l.useState(!1),[r,m]=l.useState(s),[x,f]=l.useState(!1),c=l.useRef(null),{toast:p}=S(),a=T({mutationFn:()=>y(r.trim()),onSuccess:()=>{o(!1),p({title:"Guardado",description:"Los cambios se han guardado correctamente"})},onError:t=>{p({title:"Error",description:"No se pudieron guardar los cambios",variant:"destructive"}),console.error("Save error:",t)}}),N=()=>{n||(o(!0),setTimeout(()=>{c.current&&(c.current.focus(),c.current.select())},0))},g=()=>{r.trim()!==s.trim()?a.mutate():o(!1)},h=()=>{m(s),o(!1)},w=t=>{t.key==="Escape"&&(t.preventDefault(),h()),(t.ctrlKey||t.metaKey)&&t.key==="Enter"&&(t.preventDefault(),g())},k=s||d,P=!s||typeof s=="string"&&s.trim()==="";return C?e.jsxs("div",{className:`relative ${u}`,children:[e.jsx(b,{ref:c,value:r,onChange:t=>{const j=t.target.value;(!i||j.length<=i)&&m(j)},onKeyDown:w,placeholder:d,rows:E,disabled:a.isPending,className:`
          ${a.isPending?"opacity-50":""}
        `}),i&&e.jsxs("div",{className:"text-xs text-muted-foreground mt-1",children:[r.length," / ",i]}),e.jsxs("div",{className:"flex gap-1 mt-2",children:[e.jsx(v,{size:"sm",onClick:g,disabled:a.isPending||r.trim()==="",children:a.isPending?e.jsx(D,{className:"w-3 h-3 animate-spin"}):e.jsx(I,{className:"w-3 h-3"})}),e.jsx(v,{size:"sm",variant:"outline",onClick:h,disabled:a.isPending,children:e.jsx(K,{className:"w-3 h-3"})})]}),e.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:"Tip: Ctrl/Cmd + Enter para guardar, Esc para cancelar"})]}):e.jsxs("div",{className:`relative group cursor-pointer ${u}`,onMouseEnter:()=>f(!0),onMouseLeave:()=>f(!1),onClick:N,children:[e.jsx("div",{className:`
            ${P?"text-muted-foreground italic":""}
            ${x&&!n?"bg-muted/50 rounded px-2 py-1 -mx-2 -my-1":""}
            transition-colors duration-200
            ${n?"cursor-not-allowed opacity-50":""}
            whitespace-pre-wrap min-h-[60px] flex items-start
          `,children:k}),x&&!n&&e.jsx($,{className:"absolute -right-6 top-0 w-4 h-4 text-muted-foreground opacity-70"})]})}export{V as I};
